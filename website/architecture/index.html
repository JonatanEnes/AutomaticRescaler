
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.3.0" name="generator"/>
<title>Architecture - Serverless Containers documentation</title>
<link href="../assets/stylesheets/main.6e35a1a6.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#high-level-diagram">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="Serverless Containers documentation" class="md-header-nav__button md-logo" href=".." title="Serverless Containers documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            Serverless Containers documentation
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Architecture
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header-nav__source">
<a class="md-source" href="https://github.com/JonatanEnes/ServerlessContainers/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    JonatanEnes/ServerlessContainers
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Serverless Containers documentation" class="md-nav__button md-logo" href=".." title="Serverless Containers documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    Serverless Containers documentation
  </label>
<div class="md-nav__source">
<a class="md-source" href="https://github.com/JonatanEnes/ServerlessContainers/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    JonatanEnes/ServerlessContainers
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../use_case/" title="Use case">
      Use case
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Architecture
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Architecture">
      Architecture
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#high-level-diagram">
    High-level diagram
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#microservice-architecture">
    Microservice architecture
  </a>
<nav aria-label="Microservice architecture" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#passive-microservices">
    Passive Microservices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#active-microservices">
    Active Microservices
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#othercommon-microservices-and-databases">
    Other/Common Microservices and Databases
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#more-info">
    More info
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deployment/" title="Deployment">
      Deployment
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sponsors/" title="Sponsors">
      Sponsors
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="http://bdwatchdog.dec.udc.es/serverless/index.html" title="Homepage (external)">
      Homepage (external)
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../code/src/" title="Source code (external)">
      Source code (external)
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#high-level-diagram">
    High-level diagram
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#microservice-architecture">
    Microservice architecture
  </a>
<nav aria-label="Microservice architecture" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#passive-microservices">
    Passive Microservices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#active-microservices">
    Active Microservices
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#othercommon-microservices-and-databases">
    Other/Common Microservices and Databases
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#more-info">
    More info
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset"><a class="md-icon md-content__icon" download href="../pdf/combined.pdf" title="PDF Export"></a>
<a class="md-content__button md-icon" href="https://github.com/JonatanEnes/ServerlessContainers/edit/master/docs/architecture.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1>Architecture</h1>
<h2 id="high-level-diagram">High-level diagram</h2>
<p>This framework has been designed using a microservice approach in order
to ease its development as well as to create speciliazed units that can 
be reused or improved in isolation. In addition, by using this paradigm 
it is also possible to implement framework that inherently presents an 
internal parallelism that is useful when dealing with scenarios that 
require responsiveness, such as is the case with real-time and on-demand 
resource scaling.</p>
<p>The next image shows a high-level diagram of the scenario on which the 
framework is deployed:</p>
<p><img alt="architecture" src="../img/architecture/scenario_diagram.png"/></p>
<ul>
<li>
<p>[1] Beginning with the framework's <strong>inputs</strong>, there are two: 
1) the actions, that control the framework's behavior, both performed 
by an user or by another program through the API; and, 
2) the resource monitoring time series, currently provided by an 
external framework (<a href="https://bdwatchdog.readthedocs.io/en/latest/">BDWatchdog</a>), 
that are used in the policy decision for the resource scaling operations.</p>
</li>
<li>
<p>[2] Continuing with the actual <strong>serverlesss containers framework</strong>, which 
groups several microservices, some of which are placed on the controlled 
hosts. The framework's inner workings are further specified on the 
following sections.</p>
</li>
<li>
<p>[3] And finishing with the <strong>controlled infrastructure</strong>, which usually 
consists of several hosts running each one several containers. 
Currently only the containers backed by the cgroups file system are 
supported by design and, more specifically, Linux Containers (LXC) have 
been used and thus have been proven to work with this framewok. </p>
</li>
</ul>
<h2 id="microservice-architecture">Microservice architecture</h2>
<p>As previously stated, the design followed to create the architecture of 
this framework uses several microservices that communicate and exchange 
information. The following image shows a high-level diagram of the 
microservices layout:</p>
<p><img alt="design" src="../img/architecture/design_diagram.png"/></p>
<p>As it can be seen, the microservices can be separated into active and 
passive ones, with the difference being that the passive ones focus on 
feedback operations to keep the framework continuously updates on the
infrastructure's state, and the active ones that use such information to
change the state (the container's resource limits) accordingly as needed. </p>
<h3 id="passive-microservices">Passive Microservices</h3>
<p>The passive microservices are needed to continuosly keep updated the 
central database (State Database) with all the metada that tracks the 
state of the infrastructure, from the number of containers and its 
thresholds to the allocated amounts of resources. </p>
<p>Some passive microservices are used to create aggregated data for 
entities such as applications (i.e., representing a group of containers)
or to persist temporary information into a persistent database.</p>
<ul>
<li><strong>Structure Snapshoter</strong>: Continuously polls the limits of the containers 
and writes that information into the State Database.</li>
<li><strong>Database Snapshoter</strong>: Forwards the information temporarily stored on the
State Database to a peristent database, thus creating time series. </li>
<li><strong>Refeeder Snapshoter</strong>: Aggregates and creates new metadata from existing
one (e.g., allocated amount of CPU for an application composed of 3 containers)</li>
</ul>
<p><img alt="design" src="../img/architecture/passive_services.png"/></p>
<h3 id="active-microservices">Active Microservices</h3>
<p>The active microservices are the actual ones that perform the scaling
of the resources via changing the container resource limits on the 
underlying cgroups file system through a coordinated chain of events.</p>
<p>As described on the "Scaling policy" subsection of the "Use Case" section, 
in order to perform a scaling operation, the resource usage has to exceed
the upper, or drop below the lower limit (1). After a configured time amount 
has passed on this state, the <strong>Guardian</strong> microservice will create a scaling 
request (2) with the specific amount of resource to be changed. 
Such request will be picked up and processed by the <strong>Scaler</strong> (3) and 
applied accordingly (4).</p>
<p>More specific functionalities of the microservices are described next:</p>
<ul>
<li><strong>Guardian</strong>: Working with time windows, it matches the real resource 
usages of the containers, as provided with the external resource monitoring, 
with the container limits stored on the State Database. As a result of 
the matches it generates scaling requests. </li>
<li><strong>Scaler</strong>: Polls the State Database looking for requests to be applied to the
containers.</li>
</ul>
<p><img alt="design" src="../img/architecture/active_services.png"/></p>
<h2 id="othercommon-microservices-and-databases">Other/Common Microservices and Databases</h2>
<p>Some microservices have an auxiliar role and are used both by active and 
passive microservices.</p>
<ul>
<li><strong>Orchestrator</strong>: Exposes an API that can be used both by humans or 
scripts to configure the framework.</li>
<li><strong>Container Scaler</strong>: This microservice has to be deployed on every 
infrastructure node whose hosted containers are to be scaled. This service
is able to read and write the crgoups file system to perform the actual 
resource limit scalings.</li>
</ul>
<h2 id="more-info">More info</h2>
<p>If what is described on this documentation webpage does not answer all of 
your doubts regarding the technical details, or simply is not enough for
you and you want the specifics, this framework has been published on a 
full-length 
<a href="https://www.sciencedirect.com/science/article/pii/S0167739X19310015">paper</a> on the FGCS journal.
If you don't have access to the journal paper, you can still access the
preprint on this <a href="http://bdwatchdog.dec.udc.es/articles/serverless_containers.pdf">link</a>.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../use_case/" rel="prev" title="Use case">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Use case
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../deployment/" rel="next" title="Deployment">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Deployment
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2018 - 2020 Jonatan Enes
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/vendor.d710d30a.min.js"></script>
<script src="../assets/javascripts/bundle.a14cc5fd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7a2ea5ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>