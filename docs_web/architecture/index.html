



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Architecture - Serverless Containers documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#high-level-diagram" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Serverless Containers documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Serverless Containers documentation
            </span>
            <span class="md-header-nav__topic">
              
                Architecture
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/JonatanEnes/ServerlessContainers/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    JonatanEnes/ServerlessContainers
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Serverless Containers documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Serverless Containers documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/JonatanEnes/ServerlessContainers/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    JonatanEnes/ServerlessContainers
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../use_case/" title="Use case" class="md-nav__link">
      Use case
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Architecture
      </label>
    
    <a href="./" title="Architecture" class="md-nav__link md-nav__link--active">
      Architecture
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#high-level-diagram" class="md-nav__link">
    High-level diagram
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microservice-architecture" class="md-nav__link">
    Microservice architecture
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#passive-microservices" class="md-nav__link">
    Passive Microservices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-microservices" class="md-nav__link">
    Active Microservices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#othercommon-microservices-and-databases" class="md-nav__link">
    Other/Common Microservices and Databases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-info" class="md-nav__link">
    More info
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deployment/" title="Deployment" class="md-nav__link">
      Deployment
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../sponsors/" title="Sponsors" class="md-nav__link">
      Sponsors
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="http://bdwatchdog.dec.udc.es/serverless/index.html" title="Homepage (external)" class="md-nav__link">
      Homepage (external)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../code/src/" title="Source code (external)" class="md-nav__link">
      Source code (external)
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#high-level-diagram" class="md-nav__link">
    High-level diagram
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microservice-architecture" class="md-nav__link">
    Microservice architecture
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#passive-microservices" class="md-nav__link">
    Passive Microservices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-microservices" class="md-nav__link">
    Active Microservices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#othercommon-microservices-and-databases" class="md-nav__link">
    Other/Common Microservices and Databases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-info" class="md-nav__link">
    More info
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/JonatanEnes/ServerlessContainers/edit/master/docs/architecture.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Architecture</h1>
                
                <h2 id="high-level-diagram">High-level diagram</h2>
<p>This framework has been designed using a microservice approach in order
to ease its development as well as to create speciliazed units that can 
be reused or improved in isolation. In addition, by using this paradigm 
it is also possible to implement framework that inherently presents an 
internal parallelism that is useful when dealing with scenarios that 
require responsiveness, such as is the case with real-time and on-demand 
resource scaling.</p>
<p>The next image shows a high-level diagram of the scenario on which the 
framework is deployed:</p>
<p><img alt="architecture" src="../img/architecture/scenario_diagram.png" /></p>
<ul>
<li>
<p>[1] Beginning with the framework's <strong>inputs</strong>, there are two: 
1) the actions, that control the framework's behavior, both performed 
by an user or by another program through the API; and, 
2) the resource monitoring time series, currently provided by an 
external framework (<a href="https://bdwatchdog.readthedocs.io/en/latest/">BDWatchdog</a>), 
that are used in the policy decision for the resource scaling operations.</p>
</li>
<li>
<p>[2] Continuing with the actual <strong>serverlesss containers framework</strong>, which 
groups several microservices, some of which are placed on the controlled 
hosts. The framework's inner workings are further specified on the 
following sections.</p>
</li>
<li>
<p>[3] And finishing with the <strong>controlled infrastructure</strong>, which usually 
consists of several hosts running each one several containers. 
Currently only the containers backed by the cgroups file system are 
supported by design and, more specifically, Linux Containers (LXC) have 
been used and thus have been proven to work with this framewok. </p>
</li>
</ul>
<h2 id="microservice-architecture">Microservice architecture</h2>
<p>As previously stated, the design followed to create the architecture of 
this framework uses several microservices that communicate and exchange 
information. The following image shows a high-level diagram of the 
microservices layout:</p>
<p><img alt="design" src="../img/architecture/design_diagram.png" /></p>
<p>As it can be seen, the microservices can be separated into active and 
passive ones, with the difference being that the passive ones focus on 
feedback operations to keep the framework continuously updates on the
infrastructure's state, and the active ones that use such information to
change the state (the container's resource limits) accordingly as needed. </p>
<h3 id="passive-microservices">Passive Microservices</h3>
<p>The passive microservices are needed to continuosly keep updated the 
central database (State Database) with all the metada that tracks the 
state of the infrastructure, from the number of containers and its 
thresholds to the allocated amounts of resources. </p>
<p>Some passive microservices are used to create aggregated data for 
entities such as applications (i.e., representing a group of containers)
or to persist temporary information into a persistent database.</p>
<ul>
<li><strong>Structure Snapshoter</strong>: Continuously polls the limits of the containers 
and writes that information into the State Database.</li>
<li><strong>Database Snapshoter</strong>: Forwards the information temporarily stored on the
State Database to a peristent database, thus creating time series. </li>
<li><strong>Refeeder Snapshoter</strong>: Aggregates and creates new metadata from existing
one (e.g., allocated amount of CPU for an application composed of 3 containers)</li>
</ul>
<p><img alt="design" src="../img/architecture/passive_services.png" /></p>
<h3 id="active-microservices">Active Microservices</h3>
<p>The active microservices are the actual ones that perform the scaling
of the resources via changing the container resource limits on the 
underlying cgroups file system through a coordinated chain of events.</p>
<p>As described on the "Scaling policy" subsection of the "Use Case" section, 
in order to perform a scaling operation, the resource usage has to exceed
the upper, or drop below the lower limit (1). After a configured time amount 
has passed on this state, the <strong>Guardian</strong> microservice will create a scaling 
request (2) with the specific amount of resource to be changed. 
Such request will be picked up and processed by the <strong>Scaler</strong> (3) and 
applied accordingly (4).</p>
<p>More specific functionalities of the microservices are described next:</p>
<ul>
<li><strong>Guardian</strong>: Working with time windows, it matches the real resource 
usages of the containers, as provided with the external resource monitoring, 
with the container limits stored on the State Database. As a result of 
the matches it generates scaling requests. </li>
<li><strong>Scaler</strong>: Polls the State Database looking for requests to be applied to the
containers.</li>
</ul>
<p><img alt="design" src="../img/architecture/active_services.png" /></p>
<h2 id="othercommon-microservices-and-databases">Other/Common Microservices and Databases</h2>
<p>Some microservices have an auxiliar role and are used both by active and 
passive microservices.</p>
<ul>
<li><strong>Orchestrator</strong>: Exposes an API that can be used both by humans or 
scripts to configure the framework.</li>
<li><strong>Container Scaler</strong>: This microservice has to be deployed on every 
infrastructure node whose hosted containers are to be scaled. This service
is able to read and write the crgoups file system to perform the actual 
resource limit scalings.</li>
</ul>
<h2 id="more-info">More info</h2>
<p>If what is described on this documentation webpage does not answer all of 
your doubts regarding the technical details, or simply is not enough for
you and you want the specifics, this framework has been published on a 
full-length 
<a href="https://www.sciencedirect.com/science/article/pii/S0167739X19310015">paper</a> on the FGCS journal.
If you don't have access to the journal paper, you can still access the
preprint on this <a href="http://bdwatchdog.dec.udc.es/articles/serverless_containers.pdf">link</a>.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../use_case/" title="Use case" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Use case
              </span>
            </div>
          </a>
        
        
          <a href="../deployment/" title="Deployment" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deployment
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2020 Jonatan Enes
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>